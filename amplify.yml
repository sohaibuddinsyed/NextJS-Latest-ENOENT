version: 1
frontend:
  phases:
    preBuild:
      commands:
        - export NODE_OPTIONS='--max-old-space-size=7000'
        - npm install
    build:
      commands:
        # Run node profiler during build
        - npm run build:prof
    postBuild:
      commands:
        # Use the tick processor bundled with the Node.js to generate a profile summary
        - node --prof-process v8.log > profiled.v8log.txt
        - cat profiled.v8log.txt
  artifacts:
    baseDirectory: .next
    files:
      - "**/*"
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/* 
